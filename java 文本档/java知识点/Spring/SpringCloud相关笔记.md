#### 大型网站架构演变过程

### 网站架构演变过程

   传统架构  ----->  分布式架构  ------->SOA架构 ---------->微服务架构

### 什么是分布式架构

分布式架构就是将传统结构按照模块进行拆分，不同的人负责不同的模块，不会产生代码冲突问题，方便开发。

### 什么是SOA架构

soa架构就是将业务逻辑层提取出来，将相似的业务逻辑形成一个服务，提供外部访问接口，服务之间访问通过RPC调用实现。

### 什么是微服务架构

微服务类似于SOA架构，但是比SOA架构粒度更细，更轻量。

### 微服务架构与SOA架构区别

SOA基于webservice和ESP实现，底层基于HTTP协议和使用XML方式传输，XML在网络传输过程中会产生大量冗余。微服务由SOA架构演变而来，继承了SOA架构的优点，同时对SOA架构缺点进行改善，数据传输采用JSON格式，相比于XML更轻量和快捷，粒度更细，更加便于敏捷开发。SOA数据库会存在共享，微服务提倡每个服务连接独立的数据库。

### 微服务框架

#### 什么是微服务

SpringCloud是微服务的一种解决方案，依赖于SpringBoot的实现，包含注册中心(eureka)、客户端负载均衡（Ribbon）、网关（zuul）、分布式锁、分布式会话等。

#### 为什么使用SpringCloud

springcloud是一套非常完整的微服务解决方案，俗称“微服务全家桶”，几乎内置了微服务所使用的各种技术，可以不必集成第三方依赖。

#### Springcloud服务注册发现原理

每个springcloud服务器启动之后注册中心注册本服务器的信息，如服务别名、服务器IP、端口号等，其他服务进行请求是先根据服务别名从注册中心获取到目标服务器IP和端口号，并将获取到的信息缓存到本地，然后通过本地使用的HTTPClient等技术进行远程调用。

#### SpringCloud支持哪些注册中心

Eureka、consul、zookeeper

#### 现在Eureka闭源了，可以通过什么注册中心替代Eureka？

consul和zookeeper和nacos

### 谈谈你对微服务服务治理的思想

#### Eureka如何实现高可用

启动多台Eureka服务器，然后作为springCloud服务互相注册，客户端从Eureka集群获取信息时，按照注册的Eureka顺序对第一个Eureka进行访问。

#### @LoadBalanced注解的作用

开启客户端负载均衡。

#### Nginx与Ribbon的区别

nginx是反向代理同时可以实现负载均衡，nginx拦截客户端请求采用负载均衡策略根据upstream配置进行转发，相当于请求通过nginx服务器进行转发。Ribbon是客户端负载均衡，从注册中心读取目标服务器信息，然后客户端采用轮询策略对服务直接访问，全程在客户端操作。

nginx在服务器端进行操作，Ribbon在客户端进行操作。

#### Ribbon底层实现原理

Ribbon使用discoveryClient从注册中心读取目标服务信息，对同一接口请求进行计数，使用%去余算法获取目标服务集群索引，返回获取到的目标服务信息。

#### SpringCloud有几种调用接口的方式

使用Feign和RestTemplate

#### DiscoveryClient的作用

可以从注册中心中根据服务别名获取注册的服务器信息

#### 谈谈服务雪崩效应

雪崩效应是在大型互联网项目当中，当某个服务宕机时，调用起这个服务也会发生宕机，大型项目的微服务之间时胡同，这样就会将服务的不可用逐步扩大到各个其他服务中，从而使整个项目的服务宕机崩溃。

原因之一：单个服务存在bug

原因之二：请求访问量激增导致服务发生崩溃

原因之三：服务器硬件故障也会导致部分服务不可用

#### 在微服务中，如何保护服务？

一般使用使用Hystrix框架，实现服务隔离来避免出现服务的雪崩效应，从而达到保护服务的效果。当微服务中，高并发的数据库访问量导致服务线程阻塞，是单个服务宕机，服务的不可用会蔓延到其他服务，引起整体服务灾难性后果，使用服务降级能有效为不同的服务分配资源，一旦服务不可用则返回友好提示，不占用其他服务资源，从而避免单个服务崩溃引发整体服务的不可用。

#### 谈谈Hystrix服务保护的原理

通过服务器降级，熔断，服务隔离

#### 谈谈服务降级，熔断，服务隔离

服务降级：当客户端请求服务器端的时候，防止客户端一直等待，不会处理业务逻辑代码，直接返回一个友好的提示给客户端。

服务熔断：是在服务降级的基础上更直接的一种保护方式，当在一个统计时间范围内请求失败数量达到设定值或当前的请求错误率达到了设定的错误率阈值时开启断路，之后的请求直接走fallback方法，在设定时间后尝试恢复。

服务隔离：就是Hystrix为隔离的服务开启一个独立的线程池，这样在高并发的情况下不会影响其他服务。服务隔离有线程池和信号量两种实现方式，一般使用线程方式。

#### 服务降级底层是如何实现的？

Hystrix实现服务降级的功能是通过重写HystrixCommand中的getFallback（）方法，当Hystrix的run方法或construct执行发生错误时转而执行getFallback（）方法。

#### 分布式配置中心有哪些框架

Aplool（阿波罗），zookeeper，springcloud config。

#### 分布式配置中心的作用

动态变更项目配置信息而不必重新部署项目。

#### springcloud config可以实现实时刷新嘛？

springcloud实时刷新采用springCloud bus消息总线。

#### 什么是网关？

网关相当于一个网络服务架构的入口，所有网络请求必须通过网关转发到具体的服务。

#### 网关的作用是什么？

统一管理微服务请求，权限控制，负载均衡，路由转发，监控，安全控制黑名单和白名单等。

#### 网关和过滤器有什么区别

网关是对所有服务的请求进行分析过滤，过滤器是对单个服务而言。

#### 常用网关框架有那些？

Nginx，Zuul，Gateway

#### Zuul与Nginx有什么区别？

zuul是java语言实现的，主要为java服务提供网关服务，尤其在微服务架构中可以更加灵活的对网关进行操作。

Nginx是使用C语言实现，性能高于Zuul，但是实现自定义操作需要熟悉lua语言，对程序员要求较高，可以使用Nginx做Zuul集群。

#### 既然Nginx可以实现网关？为什么还需要使用Zuul框架

zuul是Springcloud继承的网关，使用java语言编写，可以对springcloud架构提供更灵活的服务。

#### 如何设计一套API接口

考虑到API接口的分类可以将API接口分为开发API接口和内网API接口，内网API接口用于局域网，为内部服务器提供服务。开放API接口用于对外部合作单位提供接口调用，需要遵循Oauth2.0权限认证协议。同时还需要考虑安全性，幂等性问题。

#### ZuulFilter常用有哪些方法

run（）：过滤器的具体业务逻辑

shouldFilter（）：判断过滤器是否有效

filterOrder（）：过滤器执行顺序

filterType（）：过滤器拦截位置

#### 如何实现动态Zuul网关路由转发

通过对path的配置拦截请求，通过serviced到配置中心获取转发的服务列表，zuul背部使用Ribbon实现本地负载均衡和转发。

#### Zuul网关如何搭建集群？

使用Nginx的upstream设置Zuul服务集群，通过location拦截请求并转发到upstream，默认使用轮询机制对zuul集群发送请求。

### SpringBoot快速开发框架

#### 什么是springboot？

springboot是快速开发的spring框架，能够快速整合主流架构，简化xml配置，采用全注解化，内置Http服务器（如tomcat，jetty等），通过java部署运行。

#### 为什么使用springboot？

快速开发，快速整合，配置简化，内嵌服务器

#### springBoot启动方式

主类@SpringBootApplication注解或添加@ComponentScan和@EnableAutoConfiguration注解，使用@SpringBootApllication是注意自动扫描当前包。

#### springBoot与SpringMVC的区别

springMVC是springboot的web开发框架

#### springboot与springcloud的区别

springboot是快速开发的Spring框架，springcloud是完整的微服务框架，springcloud依赖于springboot。

#### springboot常用哪些注解

@EnableAutoConfiguration作用

​    自动扫描并添加jar包依赖

@SpringBootApplication原理

  是一个组合注解，相当于@EnableAutoConfiguration和@ComponenScan

#### SpringBoot热部署使用什么

devtools

#### 热部署原理是什么？

热部署的实现原理主要依赖于java的类加载机制，在实现方式可以概括为在容器启动的时候起一条后台线程，定时的检测类文件的时间戳变化，如果类的时间戳变掉了，则重新加载整个应用的class文件，同时重启服务，重新部署。

#### 热部署原理与热加载区别是什么？

热加载是在运行时重新加载class文件，不会重启服务。

#### 你们项目中异常是如何处理的？

在web项目中，使用全局捕获异常返回统一错误信息。

#### Springboot如何实现异步执行

在启动类添加@EnableAsync表示开启对异步任务的支持，在异步服务上添加@Async

#### springboot多数据源事务如何管理

第一种方式是在service层的@TransactionManager中使用transactionManager指定DataSourceConfig中配置的事务

第二种是使用jta-atomikos实现分布式事务管理。

#### springBoot如何实现打包

进入项目目录在控制台输入mvn clean package，clean是清空已存在的项目包，package进行打包

#### springBoot性能如何优化

如果项目过大，类比较多，不使用@SpringBootApplication，采用@Compoment指定扫包范围

在项目启动时设置jvm初始内存和最大内存相同

将springboot内置服务器由tomcat设置为undertow

#### SpringBoot执行流程

使用springApplication.run（）启动，在该方法所在类添加@SpringBootApplication注解，该注解由@EnableAutoConfiguration和@ComponentScan等注解组成，@EnableAutoConfiguration自动加载springboot配置和依赖包，默认使用@ComponentScan扫描当前包及子包中所有的类，将有spring注解的类交给spring容器管理

#### springboot底层实现原理

通过@EnableAutoConfiguration自动获取配置类信息，使用反射实例化为spring类，然后加载到spring容器

### 分布式协调工具

#### 什么是zookeeper

zookeeper是java语言编写的开源框架，用协调分布式的一个工具。

#### zookeeper存储结构与特性

类似于树形结构，同一层节点名称不能重复。节点类型分为临时节点与持久节点

Zookeeper以节点方式进行存储，类似于xml树状结构；

1.   节点又分为节点名称（全路径不能重复）和节点值
   节点类型有持久性节点（持久化在硬盘上）和临时节点（会话与临时节点同死同生）
2. 节点功能：每个节点都有通知功能，当这个节点增删盖查的时候都会有事件通知

Zookeeper主要有哪些特性：

1. 一致性：数据按照顺序分批入库
2. 原子性：事务要么成功要么失败，不会局部化
3. 单一视图：客户端连接集群中任何一个zk节点，数据都是一致的
4. 可靠性：每次对zk的操作状态都会保存在服务端
5. 实时性：客户端可以读取到zk服务器的新数据

#### zookeeper中临时节点和持久节点的区别

持久节点是持久化在硬盘上，会话断开后节点也能查到；

临时节点与会话保持连接，会话在节点在，会话断开，节点也会删除；

#### zookeeper应用场景

1. 服务注册与发现的中心
2. 利用临时节点特性解决分布式锁
3. 分布式配置中心
4. 基于哨兵机制实现选举策略
5. 实现本地负载均衡
6. 基于节点事件通知特性可做消息中间件
7. 分布式事务

#### 什么场景下会导致zookeeper发生延迟通知

watch事件延迟；节点被修改后，会有事件通知发往观察者，直接接收到watch事件，观察者才会知道节点被修改；当观察者接到watch事件的那一刻，该节点又被其他修改者修改了，而近的watch事件还没有通知到观察者，就会造成延迟通知。

#### 分布式锁有哪些实现方案

1. 基于setNx实现分布式锁（麻烦，需要考虑死锁及释放问题）
2. redission实现分布式锁
3. zookeeper实现分布式锁（基于临时节点，实现简单，效率高，失效时间容易控制）

#### zookeeper实现分布式锁的原理

多个jvm在同一个zookeeper上创建同一节点（临时节点），哪个jvm能创建成功，就表示它拿到了锁，剩下的jvm保持对这个节点的监听，一旦发现这个节点被删除了，那么剩下的jvm就重新再创建这个节点，谁能创建成功谁就能够拿到这个锁，以此循环下去。

#### zookeeper实现分布式锁与Redis实现分布式锁区别

zookeeper通过创建临时节点和利用监听事件实现分布式锁，redis使用setnx命令创建相同的key，因为redis的key保证唯一，先创建的先获取锁。

不断的去尝试，去获取锁，比较耗性能

zookeeper实现分布式锁，即使获取不到锁，创建对锁的监听即可，不需要不断去尝试获取锁，性能开销小

Redis实现分布式锁，如果客户端获取到锁的时候遇到bug或挂了，还需要等到超时时间过了以后才能重新获取锁

zookeeper实现分布式锁，创建的是临时节点，客户端挂了，节点自然删除，也就达到了自动释放锁的效果

#### 使用zookeeper实现服务Master选举原理

多个服务器在启动时候，会在zookeeper上创建相同的临时节点，谁如果能够创建成功，谁就为主。如果主服务器宕机，其他备用节点获取监听信息，重新创建节点，选出主服务。

#### zookeeper集群选举原理

每台zookeeper服务器启动时会发生投票，每次投票后，服务器统计投票信息，如果有机器获取半数以上的投票数则leader产生。

### 微服务常用解决方案

#### 谈谈网站跨域解决方案

1. 使用json缺点只能发送get请求
2. 使用httpclient进行转发，效率低
3. 设置响应头允许跨域
4. 使用nginx搭建api网关
5. 使用zuul微服务搭建api接口网关

#### 分布式session一致性问题

1. 使用nginx反向代理，即ip绑定，同一个ip只能在同一个机器上访问
2. 使用数据库，但性能不高
3. tomcat内置了对session同步的支持，但是可能会产生延迟
4. 使用spring-session框架，相当于session放到redis中
5. 使用token令牌代替session

#### 消息中间件产生的背景

传统的web项目采用的http协议基于请求和响应传输信息，请求发出等待服务器端响应，如果服务器端不会及时响应客户端会一直等待。

#### http协议同步接口调用失败了怎么做？

采用消息补充机制重新发送请求

#### 消息队列异步通讯与同步通讯区别

同步通讯是客户端直接请求发往服务器，等待服务器处理完请求并返回响应信息后才会继续向下执行。消息队列独立于客户端和服务端，单独架设消息队列服务器，对于不必立即获取响应和处理过程复杂的请求，客户端可以将请求发往消息队列然后立即返回，指定的消费者处理请求，这样客户端不必持续等待。

#### jms消息通讯模型有哪些

消息队列：点对点，发布订阅

#### 消息中间件应用场景

发送邮件或短信的服务，秒杀，运行过程复杂耗时的服务

#### 发布订阅与点对点通讯的区别

发布订阅是生产者发布的一个主题，所有订阅该主题的消费者都会参与消费，消息会被重复消费。点对点通讯是一个消息只能有一个消费者消费，需要保证数据的幂等性。

#### 如何保证JMS可靠消息

ActiveMQ采用消息签收机制保证数据的可靠性，消息签收有三种方式：自动签收，手动签收，事务，默认自动签收。如果是带事务的消息，事务执行完毕后自动签收，事务回滚则重新发送。

#### ActiveMQ服务端宕机了，消息会丢失嘛？

生产者可以通过setDeliveryMode方法设置消息模式，当设置为非持久化时服务器宕机后消息将销毁，重启服务后无法被继续消费。当设置为持久化服务器宕机后消息将保存在服务器中，重启后消费者还可以继续消费未处理完毕的消息。

#### RabbitMQ与其他MQ有什么不同？

rabbitmq是用erlang语言实现，安装RabbitMQ之前需要先安装erlang环境，RabbitMQ只支持AMQP协议，用于对稳定性要求比较高的企业。

#### RabbitMQvirtualHost的作用

virtualHost相当于是虚拟的RabbitMQ服务器，每个VirtualHost都是独立的，起到隔离交换机，队列的作用，不同的项目组可以连接到不同的virtualHost不会互相影响。

#### 谈谈RabbitMQ五种队列形式

点对点模式：生产者生成的消息由一个消费者消费；

工作模式：在消费者集群的情况下，可以根据消费者服务器的性能分配消息，即性能好的服务器多消费，新歌能次的少消费。

发布订阅模式：在生产者和队列之间插入一个交换机，有交换机转发到该交换机的绑定的队列；

路由模式：路由模式是基于发布订阅模式，只是在生产者向交换机生产消息时绑定一个routingkey，交换机想绑定同一个routing的队列转发消息；

通配符模式：是对路由模式的补充，使用通配符进行routingkey匹配，通配符有#和*，#代表匹配多个，*代表匹配一个。

#### RabbitMQ四种交换机类型

Fanout：以这种方式连接到交换机的队列都可以获得交换机的转发；

Direct：生产者绑定direct类型的交换机，在向交换机发送消息时绑定routingkey，交换机会将这条消息发送到相同routingKey的队列。

topic：和Direct相似，可以在routingkey中使用通配符，#代表多个匹配，*代表单个匹配，routingkey使用“.”作为分隔符。

Headers：类似Direct，使用多个消息代替路由键建立路由规则，通过消息头匹配来转发消息。

#### RabbitMQAMQP协议原理

在RabbitMQ中，生产者将消息发送到交换机，交换机将消息根据路由策略将消息发送到绑定的消息队列，消费者通过消息队列获取并消费消息。

### 高并发解决方案

#### 高性能Nginx+Lua

#### 什么是DNS解析域名？

DNS域名解析就是讲域名转化为不需要显示端口（二级域名端口一般为80）的ip地址，域名解析的一般先去本地环境host文件读取配置，解析成对应的IP地址，根据ip地址访问对应的服务器。若host文件未配置，则会去网络运营商获取对应的ip地址和域名。

#### 你用过哪些外网映射工具

花生壳，natapp，ngrok

#### 什么Nginx

Nginx是一个高级的轻量级web服务器，有俄罗斯科学家开发的，具有如下有点：

1. 占用内存少，并发量强，支持多种并发连接，效率高
2. 能够作为负载均衡服务器（内部直接支持Rails和PHP）代理服务器。Nginx用c编写和cpu占有小。
3. 安装启动简单，配置简洁，bug少，一般几个月不需要重启且不会宕机，稳定性和安全性好。

#### Nginx的作用

反向代理、负载均衡、配置主备tomcat、动静分离

#### Nginx应用场景

做HTTP服务器、反向代理服务器、静态资源服务器

#### 什么是反向代理？

代替真是服务器接收网络请求，然后请求转发到真实服务器

#### 反向代理的作用

隐藏真实服务器，使真实服务器只能通过内网访问，保护了真实服务器不被攻击。配置负载均衡，减轻单台真实服务器的压力。配置主备服务器，保持服务稳定运行。

#### Nginx如何配置反向代理

首先到DNS服务器做域名解析，如果是局域网在hosts文件中配置IP和域名对应关系。编辑nginx的nginx.conf文件，配置server_name为指向nginx服务器的域名，location拦截请求，如果访问nginx本地资源则配置root，如果是反向代理到真实服务器则配置proxy_pass为服务器地址。

#### 说说常用nginx的相关配置

upstream负载均衡配置

server  ip  weight  backup  配置tomcat集群

proxy_connect_timeout,proxy_read_timeout,proxy_send_timeout  连接时间，真实服务器响应时间、返回结果时间

location 匹配用户请求url

root 配置本地资源路径

proxy_pass  配置真实服务器地址

![反向代理](C:\Users\HITO_JAVA5\Desktop\最近整理的文本\笔记2\图片\反向代理.png)

#### LVS与Nginx区别

LVS是四层反向代理，基于TCP和UDP协议，可用于管理Nginx集群，抗负载能力强。

Nginx是七层反向代理，基于HTTP协议，用于管理真实服务器集群。

#### location的作用

匹配用户请求url，根据不同请求转发到不同的服务器

#### nginx中如何配置负载均衡

在upstream中配置多个server，在location的proxy_pass配置为http：//+upstream名称

#### 四层负载均衡与七层负载均衡区别

四层负载均衡基于TCP和UDP协议，通过IP+端口号接受请求并转发到服务器。七层负载均衡基于HTTP协议，通过url或主机名接收请求并转发到服务器

#### 四层负载均衡有那些实现方案

LVS、F5

#### 负载均衡有那些算法

轮询算法：按照时间顺序分配到不同的服务器，当其中一台服务器宕机则被自动提出，切换到正常的服务器。

权重算法：按照分配给服务器的权重比例来分发到不同服务器，权重比例越高，则访问几率越大。

IP绑定（ip_hash）：根据访问的IP的哈希结果来判定，是同一个IP访问一台固定的后端服务器，同时解决动态页面的session问题。

#### 服务器集群后，会产生哪些问题

分布式锁

分布式全局ID

分布式session一致性问题

分布式事务

分布式任务调度

分布式日志收集

分布式配置中心

#### 什么是动态负载均衡

一般情况下，使用nginx搭建服务器集群，每次修改nginx.conf配置文件都需要重启nginx服务器。动态负载均衡就是修改nginx.conf配置文件后不必重启nginx而使配置生效。

#### Nginx如何实现动态负载均衡

搭建Nginx+Consul+Upsycn环境。nginx实现服务的反向代理和负载均衡。consul是一个开源的注册中心和服务发现的框架，通过HTTP api 来发现服务，注册服务。同时支持故障发现，k/v存储，多数据中心，Raft算法等多中高可用特性。consul在nginx动态负载均衡作用是通过Http api注册和发现服务.Upsycn是新浪微博的开源框架，在nginx动态负载均衡的作用是consul的后端的server列表，即获取Nginx的上游服务器（Upstream server）信息，并动态更新Nginx的路由信息。

#### 什么是Http协议

超文本传输协议

#### Http协议组成部分

http协议是基于TCP协议封装成超文本传输协议，包括请求（request）和响应（response），http协议请求（request）分为请求参数（request params）和方法类型（request method）、请求头（request Header）、请求体（request body）。

响应（response）分为响应状态（response state），响应头（response header）、响应体（response body）等。

#### TCP与UDP区别

udp：

1. 是面向无连接，将数据及源的封装成数据包中，不需要建立连接
2. 每个数据包的大小在限制64k内
3. 因无连接，是不可靠协议
4. 不需要建立连接，速度快

tcp：

1. 建立连接，形成传输数据的通道
2. 在连接中进行大数据量会传输，以字节流方式
3. 通过三次握手完成连接，是可靠协议
4. 必须建立连接m效率会稍低

#### 谈谈七层网络模型

- 应用层：客户端的各种应用、app；
- 表示层：进行数据的格式区分，如图片、编码；
- 会话层：本地主机与远程主机的会话管理；
- 传输层：定义传输数据的协议端口号，TCP和UDP是这一层的协议
- 网络层：进行逻辑地址寻址；
- 数据链路层：建立逻辑连接，进行硬件地址寻址；
- 物理层：建立物理连接；

#### Nginx如何实现TCP四层负载均衡

在nginx.conf文件中配置tcp模块，在upstream块中定义socket服务器负载均衡，其余与nginx配置七层负载均衡相同。

tcp{

####定义多个上游服务器

upstream  itmayeidu{

####定义TCP模块上游服务器

server 192.168.5.165:8001

server 192.168.5.165:8002

}

server{

listen   9999；

server_name  192.168.212.137；

###反向代理###

proxy_pass  itmayeidu；

}

}

#### lvs与Nginx区别

lvs工作在网络第四层，nginx工作在网络第七层；lvs比nginx抗负载能力强；lvs对网络依赖性强，nginx对网络依赖性弱；lvs几乎可以所有应用做负载均衡，比如数据库。

#### lvs与keepalived区别

lvs可以实现负载均衡，但是无法实现健康检查。keepalived可以进行健康检查实现高可用。

#### keepalived作用

keepalived软件可以进行健康检查，而且能同时实现LVS的高可用性，解决LVS单点故障的问题

#### 如何实现双机主从热备

Nginx+Tomcat：在upstream中配置多台服务器，从服务器后加backup keepalived+Nginx：在多台nginx服务器上安装keepalived，将主服务器state设置为MASTER,从服务器设置为BACKUP，主服务器的优先级要高于服务器

#### lvs+keeppalived+nginx架构流程图

![0932070826838164e5aef6fdb15d374](C:\Users\HITO_J~1\AppData\Local\Temp\WeChat Files\0932070826838164e5aef6fdb15d374.png)

#### 项目发布如何不影响到正常用户访问，实现7*24小时访问

可以两台机子互为热备，平时各自负责各自的服务。在做上线更新的时候，关闭一台服务器的tomcat后，nginx自动把流量切换到另外一台服务的后备机上，从而实现无痛更新，保持服务的持续性，提高服务的可靠性，耳聪保证服务器7*24小时运行。

#### 项目发生故障宕机了，如何处理

使用lvs+keepalived+Nginx做主从热备，从lvs管理nginx集群，nginx管理服务器集群，在服务器宕机的情况下keepalived启动健康检测，多次重启吴国可以短信通知运维人员及时维护。

#### 动态网站和静态网站的区别

在浏览器中打开一个网站，点击鼠标右键查看源码，多次请求后如果源码不产生变化就是静态网站，变化就是动态网站。

#### 动态页面静态化的作用

便于搜索引擎抓取和排名

#### 什么是动静分离架构模式

静态页面与动态页面分开不同系统访问的架构设计方法，静态页面与动态页面以不同域名区分。

#### 如何搭建动静分离

以nginx服务器作为静态资源服务器，静态资源和动态资源访问分开配置，静态资源在location中使用本地文件路径配置方式，动态资源使用proxy_pass配置到后台服务器。

如：

​     ###静态资源访问

  server {

   listen    80;

   server_name  static.itmayiedu.com;

   location /static/imgs {

​      root F:/;

​      index  index.html index.htm;

​    }

  }

\###动态资源访问

server {

   listen    80;

   server_name  www.itmayiedu.com;

 

   location / {

​     proxy_pass http://127.0.0.1:8080;

​     index  index.html index.htm;

​    }

  }

#### 动静分离与前后分离区别

动静分离是将静态资源和动态资源存放在不同服务器中，前后分离是将前端和后台分离，前端通过api调用后台接口

#### 如何控制浏览器静态资源缓存

静态资源存在缓存的原因是项目上线时，浏览器缓存中的静态资源导致与服务器将淘汰资源的代码发生冲突

#### Http状态码304的作用

表示浏览器存在静态资源缓存就不从服务器获取静态资源

### 高并发服务限流特级

#### 高并发服务限流特级有哪些算法？

传统计算器算法，滑动窗口计数器算法，令牌桶算法和漏桶算法。

#### 传统计数器限流算法的弊端

传统计数器限流方式不支持高并发，存在线程安全问题，若大量访问请求集中在计数器最后时刻，计数器极易发生临界问题，访问的请求无法完成。

#### 什么是滑动窗口计数器？

滑动窗口计数器是一种服务限流的算法，相对于计数器方法的实现，滑动窗口实现会更加平滑，并自动消除毛刺。其原理是当有访问进来时，会判断若干个单位来请求是否朝富哦设置的阈值，并对当前时间片的请求数+1.

